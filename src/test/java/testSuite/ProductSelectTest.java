package testSuite;

import config.Session;
import io.qameta.allure.*;
import org.junit.jupiter.api.*;
import pages.*;

import java.io.IOException;

import static io.qameta.allure.SeverityLevel.CRITICAL;

public class ProductSelectTest {
    @BeforeEach
    public void openBrowser(){
        Session.getSession().getBrowser().get("https://www.saucedemo.com/");
    }

    @AfterEach
    public void closeBrowser(){
        Session.getSession().getBrowser().quit();
    }

    @Test
    @Order(1)
    @DisplayName("Test de productos en el carrito de compra")
    @Description("Test para validar que exista la misma cantidad de productos en el carrito")
    @Severity(CRITICAL)
    @Owner("UCB")
    public void validatePurchaseSuccessfully() throws IOException {
        int expectedProducts = 3;
        LoginPage loginPage = new LoginPage();
        loginPage.fillData("standard_user", "secret_sauce");
        loginPage.selectLogin();

        ProductsPage productsPage = new ProductsPage();
        productsPage.selectProducts(expectedProducts);

        MenuPage menuPage = new MenuPage();
        menuPage.selectPurchaseButton();

        CardPage cardPage = new CardPage();

        int actualProducts = cardPage.getProductsQuantity();

        Assertions.assertEquals(actualProducts, expectedProducts);
    }
}
